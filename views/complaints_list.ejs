<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <title>Lista de Quejas</title>
    <link rel="stylesheet" href="/complaint_list_style.css">

    <script src="https://www.google.com/recaptcha/api.js?render=6Ld0TagrAAAAACNejDK0_2e_NdQxsTWR15btG5xs"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">

    <style>
        body {
            background-color: #f8f9fa;
        }

        .custom_button {
            height: 37px;
            background-color: #339BBF;
            border-radius: 8px;
            font-size: 1.2rem;
            font-weight: 600;
            color: #fff;
        }

        .custom_button:hover {
            background-color: #017297;
            color: #fff
        }

        .icon-bg {
            width: 80px;
            height: 80px;
            border-radius: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 20px auto;
            font-size: 2.5rem;
        }

        .icon-red {
            background: #e74c3c;
            color: #fff;
        }

        .icon-green {
            background: #1abc9c;
            color: #fff;
        }

        .title {
            font-weight: 700;
            font-size: 2rem;
            margin-top: 20px;
        }

        .subtitle {
            color: #6c757d;
            margin-bottom: 40px;
        }

        .custom_table {
            border-radius: 20px;
            overflow: hidden;
            border: none;
        }

        .custom_table td {
            border: none;
            color: #6c757d;
            font-size: 1rem;
        }

        .custom_th {
            background-color: #10B981 !important;
            color: #fff !important;
            font-size: 1.2rem;
            border: none !important;
            font-weight: 600 !important;
        }


        .custom_table td:first-child {
            width: 50%;
        }

        .custom_table td:last-child {
            text-align: left;
            word-wrap: break-word;
            color: #6c757d;
        }
    </style>

</head>

<body class="">
    <nav class="navbar navbar-light bg-white shadow-sm mb-4">
        <div class="container-fluid d-flex justify-content-start">
            <a href="/home" class="btn custom_button d-flex align-items-center">
                <svg xmlns="http://www.w3.org/2000/svg" height="35" viewBox="0 0 24 24" width="35" fill="#fff"
                    class="me-2">
                    <path d="M0 0h24v24H0z" fill="none" />
                    <path d="M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z" />
                </svg>
                Volver al inicio
            </a>
        </div>
    </nav>

    <div class="container text-center">
        <div class="icon-bg icon-blue mb-3" style="background:#10B981;">
            <svg xmlns="http://www.w3.org/2000/svg" height="40" viewBox="0 0 24 24" width="40" fill="#fff">
                <path d="M0 0h24v24H0z" fill="none" />
                <path
                    d="M19 5v14H5V5h14m1.1-2H3.9c-.5 0-.9.4-.9.9v16.2c0 .4.4.9.9.9h16.2c.4 0 .9-.5.9-.9V3.9c0-.5-.5-.9-.9-.9zM11 7h6v2h-6V7zm0 4h6v2h-6v-2zm0 4h6v2h-6zM7 7h2v2H7zm0 4h2v2H7zm0 4h2v2H7z" />
            </svg>
        </div>
        <div class="title">Consultar Quejas</div>
        <div class="subtitle">
            Consultar las quejas realizadas.

            <div class="container" id="complaints-container" style="display:none;">

                <div class="row">


                </div>
                <div class="col">

                    <% if (complaints.length> 0) { %>
                        <table class=" table custom_table table-striped mt-4">
                            <thead>
                                <tr>
                                    <th class="custom_th">Entidad</th>
                                    <th class="custom_th">Descripci√≥n</th>
                                </tr>
                            </thead>
                            <tbody>
                                <% complaints.forEach(c=> { %>
                                    <tr>
                                        <td>
                                            <%= c.public_entity %>
                                        </td>
                                        <td>
                                            <%= c.description %>
                                        </td>
                                    </tr>
                                    <% }) %>
                            </tbody>
                        </table>
                        <% } else { %>
                            <div class="alert alert-info">No hay quejas registradas.</div>
                            <% } %>
                                <div class="d-flex justify-content-center mt-4">
                                    <a href="/generate-report" class="btn custom_button d-flex align-items-center">
                                        Generar Reporte
                                    </a>
                                </div>


                </div>



                <script>
                    grecaptcha.ready(function () {
                        grecaptcha.execute('6Ld0TagrAAAAACNejDK0_2e_NdQxsTWR15btG5xs', { action: 'view_list' }).then(function (token) {
                            fetch('/verify-captcha', {
                                method: 'POST',
                                headers: {
                                    'Content-Type': 'application/json'
                                },
                                body: JSON.stringify({ token })
                            })
                                .then(res => res.json())
                                .then(data => {
                                    if (data.success && data.score > 0.5) {
                                        document.getElementById('complaints-container').style.display = 'block';
                                    } else {
                                        alert('No pudimos verificar que eres humano');
                                    }
                                });
                        });
                    });
                </script>
</body>

</html>